import numpy as np
from scipy.special import psi
import time

# start = time.time()

def func(k, mu, T, ux, uxx, uy, uyy, uxy, x, y):
    a0 = (k**2*(-16.0*mu**2 + 4.0*ux + 8.0*uxx*x + 8.0*uy + 8.0*uyy*y)
            + 3.0*k**4.0 - mu**2*(16.0*ux + 32.0*uxx*x + 16.0*uy + 16.0*uyy*y)
            + 16.0*mu**4.0 + 8.0*ux*(uy + uyy*y) + 16.0*uxx*uy*x
            + 16.0*uxx*uyy*x*y - 16.0*uxy**2*x*y + 4.0*uy**2 + 8.0*uy*uyy*y) + 0.j
    a1 = 6.0*k**2 + 4.0*ux + 8.0*uxx*x + 8.0*uy + 8.0*uyy*y + 0.j
    a2 = 3.0 + 0.j
    b0 = ((k**2 - 4.0*mu**2 + 2.0*uy)
          * (k**2*(-4.0*mu**2 + 2.0*ux + 4.0*uxx*x + 2.0*uy + 4.0*uyy*y)
             + k**4.0 - mu**2*(8.0*ux + 16.0*uxx*x) + 4.0*ux*(uy + 2.0*uyy*y)
             + 8.0*x*(uxx*(uy + 2.0*uyy*y) - 2.0*uxy**2*y))) + 0.j
    b1 = (k**2*(4.0*ux + 8.0*uxx*x + 8.0*uy + 8.0*uyy*y) + 3.0*k**4.0
          + mu**2*(16.0*ux + 32.0*uxx*x - 16.0*uy - 16.0*uyy*y) + 16.0*mu**4.0
          + 8.0*ux*(uy + uyy*y) + 16.0*uxx*uy*x + 16.0*uxx*uyy*x*y
          - 16.0*uxy**2*x*y + 4.0*uy**2 + 8.0*uy*uyy*y) + 0.j
    b2 = 3.0*k**2 + 8.0*mu**2 + 2.0*ux + 4.0*uxx*x + 4.0*uy + 4.0*uyy*y + 0.j

    a0 = (843763333104816 + 0.j);
    a1 = (151786440 + 0.j);
    a2 = 3.0;
    b0 = 18884 + 0.j;
    b1 = (845338836314096 + 0.j) ;
    b2 = (75940652 + 0.j);

    def mysqrt(x): return np.sqrt((1.+0j)*x)

    aux0=((27.*(b0**2))+((4.*(b1**3.))+((-18.*(b0*(b1*b2)))+(4.*(b0*(b2**3.))))))-((b1**2)*(b2**2));
    aux1=(-27.*b0)+((9.*(b1*b2))+((-2.*(b2**3.))+(3.*((mysqrt(3.))*(mysqrt(aux0))))));
    aux2=((27.*(b0**2))+((4.*(b1**3.))+((-18.*(b0*(b1*b2)))+(4.*(b0*(b2**3.))))))-((b1**2)*(b2**2));
    aux3=(-27.*b0)+((9.*(b1*b2))+((-2.*(b2**3.))+(3.*((mysqrt(3.))*(mysqrt(aux2))))));
    aux4=(-(1./3)*((2.**(1./3))*(((3.*b1)-(b2**2))*(aux1**-(1./3)))))+((1./3)*((2.**-(1./3))*(aux3**(1./3))));
    z1=1j*((-(1./3)*b2)+aux4);

    aux0=((27.*(b0**2))+((4.*(b1**3.))+((-18.*(b0*(b1*b2)))+(4.*(b0*(b2**3.))))))-((b1**2)*(b2**2));
    aux1=(-27.*b0)+((9.*(b1*b2))+((-2.*(b2**3.))+(3.*((mysqrt(3.))*(mysqrt(aux0))))));
    aux2=(2.**-(2./3))*((1.+((0.+1.j)*(mysqrt(3.))))*(((3.*b1)-(b2**2))*(aux1**-(1./3))));
    aux3=((27.*(b0**2))+((4.*(b1**3.))+((-18.*(b0*(b1*b2)))+(4.*(b0*(b2**3.))))))-((b1**2)*(b2**2));
    aux4=(-27.*b0)+((9.*(b1*b2))+((-2.*(b2**3.))+(3.*((mysqrt(3.))*(mysqrt(aux3))))));
    aux5=-(1./6)*((2.**-(1./3))*((1.+((0.+-1.j)*(mysqrt(3.))))*(aux4**(1./3))));
    z2=1j*((-(1./3)*b2)+(((1./3)*aux2)+aux5));

    aux0=((27.*(b0**2))+((4.*(b1**3.))+((-18.*(b0*(b1*b2)))+(4.*(b0*(b2**3.))))))-((b1**2)*(b2**2));
    aux1=(-27.*b0)+((9.*(b1*b2))+((-2.*(b2**3.))+(3.*((mysqrt(3.))*(mysqrt(aux0))))));
    aux2=(2.**-(2./3))*((1.+((0.+-1.j)*(mysqrt(3.))))*(((3.*b1)-(b2**2))*(aux1**-(1./3))));
    aux3=((27.*(b0**2))+((4.*(b1**3.))+((-18.*(b0*(b1*b2)))+(4.*(b0*(b2**3.))))))-((b1**2)*(b2**2));
    aux4=(-27.*b0)+((9.*(b1*b2))+((-2.*(b2**3.))+(3.*((mysqrt(3.))*(mysqrt(aux3))))));
    aux5=-(1./6)*((2.**-(1./3))*((1.+((0.+1.j)*(mysqrt(3.))))*(aux4**(1./3))));
    z3=1j*((-(1./3)*b2)+(((1./3)*aux2)+aux5));

    f1 = ((a2*z1**4 - a1*z1**2 + a0)/((z2**2 - z1**2)*(z3**2 - z1**2)*z1)*
          1/np.tanh(z1/(2*T)))
    f2 = ((a2*z2**4 - a1*z2**2 + a0)/((z3**2 - z2**2)*(z1**2 - z2**2)*z2)*
          1/np.tanh(z2/(2*T)))
    f3 = ((a2*z3**4 - a1*z3**2 + a0)/((z1**2 - z3**2)*(z2**2 - z3**2)*z3)*
          1/np.tanh(z3/(2*T)))
    # print(z1, z2, z3)
    return (f1 + f2 + f3)

"""print(func(10, 10, 5, 100, 400, 1, 4, 2, 3, 8))
print(func(10, 10, 20, 1, 4, 1, 4, 2, 3, 8))
print(func(10, 10, 100, 1, 4, 1, 4, 2, 3, 8))
print(func(10, 10, 200, 1, 4, 1, 4, 2, 3, 8))"""
